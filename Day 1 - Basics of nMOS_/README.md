# Day 1: nMOSFET I-V Characteristics üî¨

### üéØ Introduction / Background

This experiment marks the first step in understanding the analog foundation of digital circuits. The objective is to characterize the fundamental **current-voltage (I-V) behavior** of an N-channel MOSFET (NMOS), which serves as the primary component in the pull-down network of CMOS logic.

> **Why is this important?** High-level tools like Static Timing Analysis (STA) rely on pre-characterized models (`.lib` files) that contain timing information. This timing data is not arbitrary; it is derived directly from SPICE simulations of these fundamental transistor characteristics. The **drive strength**, or the amount of current a transistor can provide, dictates how quickly it can charge or discharge a capacitive load, which directly translates to circuit speed.

The core principle we are observing is **strong inversion**:

> When the gate-to-source voltage ($V_{gs}$) exceeds a specific **threshold voltage ($V_t$)**, the p-type substrate beneath the gate inverts to form an n-type conducting channel, allowing current to flow from drain to source.

> üñºÔ∏è <img width="1920" height="1080" alt="Screenshot 2025-10-17 211543" src="https://github.com/user-attachments/assets/46de4316-b2c4-4101-b7f5-f9b531f9e827" />

-----

### üìú SPICE Netlist

To perform the simulation, a SPICE netlist is created. This file is a text-based description of the circuit components, their connections (nodes), and the type of analysis to be performed. The simulation will sweep the drain-to-source voltage ($V_{ds}$) and step the gate-to-source voltage ($V_{gs}$) to generate the characteristic I-V curves.
The simulation process, as illustrated below, combines this structural netlist with a separate file containing the physical model parameters.

> üñºÔ∏è <img width="1920" height="1080" alt="Spice Setup" src="https://github.com/user-attachments/assets/697e343f-3497-453a-95ce-bad2939866b4" />


  * **SPICE Netlist:** This describes the circuit's topology‚Äîwhat components are used and how they are connected.
  * **SPICE Model Parameters:** This file contains the complex, physics-based equations and foundry-specific values that define *how* a transistor behaves. This includes formulas for its threshold voltage ($V_t$) and its drain current ($I_d$) in both the linear and saturation regions.
  * **SPICE Software:** The simulator engine takes both files as input, solves the complex equations for the given circuit, and generates the output data, which can then be plotted.

The netlist used for this simulation is `day1_nfet_idvds_L2_W5.spice`.
**This is for Understanding**
```spice
* Week4: Day1: NMOS Id vs Vds characteristics (L=2um, W=5um)

* Include the SKY130 device models
.include ../../sky130.lib.spice

* Define the circuit components
* Format: M<name> <drain> <gate> <source> <body> <model> W=<width> L=<length>
M1 Vd Vg 0 0 sky130_fd_pr__nfet_01v8 L=2u W=5u

* Define the voltage sources
* Format: V<name> <positive_node> <negative_node> <value>
Vd Vd 0 0       ; Drain voltage source (swept by .dc command)
Vg Vg 0 0       ; Gate voltage source (stepped by .dc command)

* Define the analysis to be performed
* Sweep Vd from 0 to 1.8V in 0.01V increments
* Step Vg from 0 to 1.8V in 0.3V increments
.dc Vd 0 1.8 0.01 Vg 0 1.8 0.3

.end
```
<details>
<summary>üìú Click to expand original spice script</summary>

```spice
*Model Description
.param temp=27
*Including sky130 library files
.lib "sky130_fd_pr/models/sky130.lib.spice" tt

*Netlist Description
XM1 Vdd n1 0 0 sky130_fd_pr__nfet_01v8 w=5 l=2

R1 n1 in 55

Vdd vdd 0 1.8V
Vin in 0 1.8V

*simulation commands
.op
.dc Vdd 0 1.8 0.1 Vin 0 1.8 0.2
.control
run
display
setplot dc1
.endc

.end
```
-----
</details>

### üìä Plots & Figures

The simulation generates a family of curves, where each curve shows the relationship between drain current ($I_d$) and drain-source voltage ($V_{ds}$) for a constant gate-source voltage ($V_{gs}$).

**Figure 1: I-V Characteristic Curves for NMOS Transistor**

> üñºÔ∏è <img width="1920" height="1080" alt="Graph" src="https://github.com/user-attachments/assets/6439e173-0258-43f5-a8c4-e6b5cbabb2bb" />

*Caption: The plot shows the drain current (Id) as a function of drain-source voltage (Vds). Each curve corresponds to a different gate-source voltage (Vgs). The linear and saturation regions are clearly visible.*

-----

### üß† Observations and Analysis

The I-V curves generated by the simulation perfectly illustrate the theoretical operating regions of a MOSFET, which are derived from fundamental device physics.

---

#### 1. The Linear (or Resistive/Triode) Region üß™

* **Condition:** This region occurs when $V_{gs} > V_t$ and the drain voltage is low, specifically $V_{ds} < (V_{gs} - V_t)$.
* **Physical Behavior:** In this state, a continuous conductive channel exists from source to drain, and the transistor acts like a voltage-controlled resistor. As seen in the plot, for small values of $V_{ds}$, the current $I_d$ increases almost linearly.

##### Governing Equation and Derivation üî¢
The equation for the drain current ($I_d$) in this region is derived from first principles by integrating the channel charge along the length of the device, as shown in the image below.

> üñºÔ∏è <img width="1920" height="1080" alt="Id derivation" src="https://github.com/user-attachments/assets/fd3ad54c-7b60-4489-a44b-9c4a3755af8d" />

The final equation gives the complete formula for drain current in the linear region:
$$I_d = \mu_n C_{ox} \frac{W}{L} \left[ (V_{gs} - V_t)V_{ds} - \frac{V_{ds}^2}{2} \right]$$

---

#### 2. The Saturation Region and "Pinch-Off"

* **Condition:** This region begins when the drain voltage becomes high enough that $V_{ds} \ge (V_{gs} - V_t)$.
* **Physical Behavior:** As $V_{ds}$ increases, the potential along the channel also increases. This reduces the gate-to-channel voltage near the drain. When this voltage difference drops below the threshold voltage ($V_t$), the inversion layer at the drain end disappears. This phenomenon is called **"pinch-off"**.

The image below provides a perfect theoretical and numerical explanation of this condition.
> üñºÔ∏è <img width="1920" height="1080" alt="vgs-vts table" src="https://github.com/user-attachments/assets/f3ed4aff-629d-4e33-80e5-e5d27af83b47" />

* **Explanation:** The table on the right numerically demonstrates the pinch-off condition ($V_{gs} - V_{ds} \le V_t$). For a fixed $V_{gs}=1V$ and $V_t=0.45V$, as $V_{ds}$ increases, the term ($V_{gs} - V_{ds}$) decreases. Once $V_{ds}$ reaches 0.55V, the condition for pinch-off is met.

Once pinched off, the current becomes largely independent of $V_{ds}$ and is primarily controlled by $V_{gs}$. This is seen in our simulation plot as the "flattening" of the curves.

* **Ideal Equation for Saturation:**
    $$I_d = \frac{1}{2} \mu_n C_{ox} \frac{W}{L} (V_{gs} - V_t)^2$$

---

#### 3. Channel Length Modulation (A Second-Order Effect)

Ideally, the current in saturation should be perfectly flat. However, the simulation plot shows a slight positive slope. This is due to **Channel Length Modulation**. As $V_{ds}$ increases beyond the saturation point, the pinch-off point moves slightly toward the source, reducing the *effective* channel length ($L_{eff}$). Since $I_d$ is inversely proportional to length, the current increases slightly. This is modeled by the parameter $\lambda$:
$$I_d = \frac{1}{2} k_n' \frac{W}{L} (V_{gs} - V_t)^2 (1 + \lambda V_{ds})$$

---

#### 4. How this Ties Back to STA Concepts üîó

This analysis is the bedrock of digital timing.
* **Drive Strength:** The saturation current ($I_{dsat}$) is the maximum current a transistor can deliver and is a direct measure of its **drive strength**.
* **Delay Calculation:** In digital circuits, propagation delay is the time taken to charge/discharge load capacitance ($t_p \propto \frac{CV}{I}$). A higher drive strength ($I_{dsat}$) means a larger current, which results in a **smaller delay**.
* **STA Models:** STA tools use complex timing models (lookup tables) that are built from thousands of SPICE simulations like this one. This experiment validates the fundamental physical behavior that those models represent.
